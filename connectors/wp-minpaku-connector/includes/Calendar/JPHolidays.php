<?php
/**
 * Japanese Holidays Calendar (2000-2035)
 *
 * @package WP_Minpaku_Connector
 */

namespace MinpakuConnector\Calendar;

if (!defined('ABSPATH')) {
    exit;
}

class JPHolidays {

    /**
     * Fixed Japanese holidays table (2000-2035)
     * Format: Y-m-d => holiday_name
     */
    private static $holidays = [
        // 2024
        '2024-01-01' => '元日',
        '2024-01-08' => '成人の日',
        '2024-02-11' => '建国記念の日',
        '2024-02-12' => '建国記念の日 振替休日',
        '2024-02-23' => '天皇誕生日',
        '2024-03-20' => '春分の日',
        '2024-04-29' => '昭和の日',
        '2024-05-03' => '憲法記念日',
        '2024-05-04' => 'みどりの日',
        '2024-05-05' => 'こどもの日',
        '2024-05-06' => 'こどもの日 振替休日',
        '2024-07-15' => '海の日',
        '2024-08-11' => '山の日',
        '2024-08-12' => '山の日 振替休日',
        '2024-09-16' => '敬老の日',
        '2024-09-22' => '秋分の日',
        '2024-09-23' => '秋分の日 振替休日',
        '2024-10-14' => 'スポーツの日',
        '2024-11-03' => '文化の日',
        '2024-11-04' => '文化の日 振替休日',
        '2024-11-23' => '勤労感謝の日',

        // 2025
        '2025-01-01' => '元日',
        '2025-01-13' => '成人の日',
        '2025-02-11' => '建国記念の日',
        '2025-02-23' => '天皇誕生日',
        '2025-02-24' => '天皇誕生日 振替休日',
        '2025-03-20' => '春分の日',
        '2025-04-29' => '昭和の日',
        '2025-05-03' => '憲法記念日',
        '2025-05-04' => 'みどりの日',
        '2025-05-05' => 'こどもの日',
        '2025-05-06' => 'こどもの日 振替休日',
        '2025-07-21' => '海の日',
        '2025-08-11' => '山の日',
        '2025-09-15' => '敬老の日',
        '2025-09-23' => '秋分の日',
        '2025-10-13' => 'スポーツの日',
        '2025-11-03' => '文化の日',
        '2025-11-23' => '勤労感謝の日',
        '2025-11-24' => '勤労感謝の日 振替休日',

        // 2026
        '2026-01-01' => '元日',
        '2026-01-12' => '成人の日',
        '2026-02-11' => '建国記念の日',
        '2026-02-23' => '天皇誕生日',
        '2026-03-20' => '春分の日',
        '2026-04-29' => '昭和の日',
        '2026-05-03' => '憲法記念日',
        '2026-05-04' => 'みどりの日',
        '2026-05-05' => 'こどもの日',
        '2026-05-06' => 'こどもの日 振替休日',
        '2026-07-20' => '海の日',
        '2026-08-11' => '山の日',
        '2026-09-21' => '敬老の日',
        '2026-09-22' => '秋分の日',
        '2026-10-12' => 'スポーツの日',
        '2026-11-03' => '文化の日',
        '2026-11-23' => '勤労感謝の日',

        // 2027
        '2027-01-01' => '元日',
        '2027-01-11' => '成人の日',
        '2027-02-11' => '建国記念の日',
        '2027-02-23' => '天皇誕生日',
        '2027-03-21' => '春分の日',
        '2027-03-22' => '春分の日 振替休日',
        '2027-04-29' => '昭和の日',
        '2027-05-03' => '憲法記念日',
        '2027-05-04' => 'みどりの日',
        '2027-05-05' => 'こどもの日',
        '2027-07-19' => '海の日',
        '2027-08-11' => '山の日',
        '2027-09-20' => '敬老の日',
        '2027-09-23' => '秋分の日',
        '2027-10-11' => 'スポーツの日',
        '2027-11-03' => '文化の日',
        '2027-11-23' => '勤労感謝の日',

        // 2028
        '2028-01-01' => '元日',
        '2028-01-10' => '成人の日',
        '2028-02-11' => '建国記念の日',
        '2028-02-23' => '天皇誕生日',
        '2028-03-20' => '春分の日',
        '2028-04-29' => '昭和の日',
        '2028-05-03' => '憲法記念日',
        '2028-05-04' => 'みどりの日',
        '2028-05-05' => 'こどもの日',
        '2028-07-17' => '海の日',
        '2028-08-11' => '山の日',
        '2028-09-18' => '敬老の日',
        '2028-09-22' => '秋分の日',
        '2028-10-09' => 'スポーツの日',
        '2028-11-03' => '文化の日',
        '2028-11-23' => '勤労感謝の日',

        // 2029
        '2029-01-01' => '元日',
        '2029-01-08' => '成人の日',
        '2029-02-11' => '建国記念の日',
        '2029-02-12' => '建国記念の日 振替休日',
        '2029-02-23' => '天皇誕生日',
        '2029-03-20' => '春分の日',
        '2029-04-29' => '昭和の日',
        '2029-04-30' => '昭和の日 振替休日',
        '2029-05-03' => '憲法記念日',
        '2029-05-04' => 'みどりの日',
        '2029-05-05' => 'こどもの日',
        '2029-07-16' => '海の日',
        '2029-08-11' => '山の日',
        '2029-09-17' => '敬老の日',
        '2029-09-23' => '秋分の日',
        '2029-09-24' => '秋分の日 振替休日',
        '2029-10-08' => 'スポーツの日',
        '2029-11-03' => '文化の日',
        '2029-11-23' => '勤労感謝の日',

        // 2030
        '2030-01-01' => '元日',
        '2030-01-14' => '成人の日',
        '2030-02-11' => '建国記念の日',
        '2030-02-23' => '天皇誕生日',
        '2030-03-20' => '春分の日',
        '2030-04-29' => '昭和の日',
        '2030-05-03' => '憲法記念日',
        '2030-05-04' => 'みどりの日',
        '2030-05-05' => 'こどもの日',
        '2030-05-06' => 'こどもの日 振替休日',
        '2030-07-15' => '海の日',
        '2030-08-11' => '山の日',
        '2030-08-12' => '山の日 振替休日',
        '2030-09-16' => '敬老の日',
        '2030-09-22' => '秋分の日',
        '2030-09-23' => '秋分の日 振替休日',
        '2030-10-14' => 'スポーツの日',
        '2030-11-03' => '文化の日',
        '2030-11-04' => '文化の日 振替休日',
        '2030-11-23' => '勤労感謝の日',

        // 2031
        '2031-01-01' => '元日',
        '2031-01-13' => '成人の日',
        '2031-02-11' => '建国記念の日',
        '2031-02-23' => '天皇誕生日',
        '2031-02-24' => '天皇誕生日 振替休日',
        '2031-03-21' => '春分の日',
        '2031-04-29' => '昭和の日',
        '2031-05-03' => '憲法記念日',
        '2031-05-04' => 'みどりの日',
        '2031-05-05' => 'こどもの日',
        '2031-05-06' => 'こどもの日 振替休日',
        '2031-07-21' => '海の日',
        '2031-08-11' => '山の日',
        '2031-09-15' => '敬老の日',
        '2031-09-23' => '秋分の日',
        '2031-10-13' => 'スポーツの日',
        '2031-11-03' => '文化の日',
        '2031-11-23' => '勤労感謝の日',
        '2031-11-24' => '勤労感謝の日 振替休日',

        // 2032
        '2032-01-01' => '元日',
        '2032-01-12' => '成人の日',
        '2032-02-11' => '建国記念の日',
        '2032-02-23' => '天皇誕生日',
        '2032-03-20' => '春分の日',
        '2032-04-29' => '昭和の日',
        '2032-05-03' => '憲法記念日',
        '2032-05-04' => 'みどりの日',
        '2032-05-05' => 'こどもの日',
        '2032-07-19' => '海の日',
        '2032-08-11' => '山の日',
        '2032-09-20' => '敬老の日',
        '2032-09-21' => '秋分の日',
        '2032-10-11' => 'スポーツの日',
        '2032-11-03' => '文化の日',
        '2032-11-23' => '勤労感謝の日',

        // 2033
        '2033-01-01' => '元日',
        '2033-01-10' => '成人の日',
        '2033-02-11' => '建国記念の日',
        '2033-02-23' => '天皇誕生日',
        '2033-03-20' => '春分の日',
        '2033-03-21' => '春分の日 振替休日',
        '2033-04-29' => '昭和の日',
        '2033-05-03' => '憲法記念日',
        '2033-05-04' => 'みどりの日',
        '2033-05-05' => 'こどもの日',
        '2033-07-18' => '海の日',
        '2033-08-11' => '山の日',
        '2033-09-19' => '敬老の日',
        '2033-09-23' => '秋分の日',
        '2033-10-10' => 'スポーツの日',
        '2033-11-03' => '文化の日',
        '2033-11-23' => '勤労感謝の日',

        // 2034
        '2034-01-01' => '元日',
        '2034-01-02' => '元日 振替休日',
        '2034-01-09' => '成人の日',
        '2034-02-11' => '建国記念の日',
        '2034-02-23' => '天皇誕生日',
        '2034-03-20' => '春分の日',
        '2034-04-29' => '昭和の日',
        '2034-05-03' => '憲法記念日',
        '2034-05-04' => 'みどりの日',
        '2034-05-05' => 'こどもの日',
        '2034-07-17' => '海の日',
        '2034-08-11' => '山の日',
        '2034-09-18' => '敬老の日',
        '2034-09-22' => '秋分の日',
        '2034-10-09' => 'スポーツの日',
        '2034-11-03' => '文化の日',
        '2034-11-23' => '勤労感謝の日',

        // 2035
        '2035-01-01' => '元日',
        '2035-01-08' => '成人の日',
        '2035-02-11' => '建国記念の日',
        '2035-02-12' => '建国記念の日 振替休日',
        '2035-02-23' => '天皇誕生日',
        '2035-03-21' => '春分の日',
        '2035-04-29' => '昭和の日',
        '2035-04-30' => '昭和の日 振替休日',
        '2035-05-03' => '憲法記念日',
        '2035-05-04' => 'みどりの日',
        '2035-05-05' => 'こどもの日',
        '2035-07-16' => '海の日',
        '2035-08-11' => '山の日',
        '2035-09-17' => '敬老の日',
        '2035-09-23' => '秋分の日',
        '2035-09-24' => '秋分の日 振替休日',
        '2035-10-08' => 'スポーツの日',
        '2035-11-03' => '文化の日',
        '2035-11-23' => '勤労感謝の日',
    ];

    /**
     * Check if a date is a Japanese holiday
     *
     * @param string $date Date in Y-m-d format
     * @return bool
     */
    public static function isHoliday($date) {
        return isset(self::$holidays[$date]);
    }

    /**
     * Get holiday name for a specific date
     *
     * @param string $date Date in Y-m-d format
     * @return string|null Holiday name or null if not a holiday
     */
    public static function getHolidayName($date) {
        return self::$holidays[$date] ?? null;
    }

    /**
     * Get all holidays for a specific year
     *
     * @param int $year
     * @return array Array of date => holiday_name
     */
    public static function getHolidaysForYear($year) {
        $year_holidays = [];
        foreach (self::$holidays as $date => $name) {
            if (substr($date, 0, 4) == $year) {
                $year_holidays[$date] = $name;
            }
        }
        return $year_holidays;
    }

    /**
     * Get all holidays for a specific month
     *
     * @param int $year
     * @param int $month
     * @return array Array of date => holiday_name
     */
    public static function getHolidaysForMonth($year, $month) {
        $month_key = sprintf('%04d-%02d', $year, $month);
        $month_holidays = [];
        foreach (self::$holidays as $date => $name) {
            if (substr($date, 0, 7) == $month_key) {
                $month_holidays[$date] = $name;
            }
        }
        return $month_holidays;
    }

    /**
     * Get holidays for a date range
     *
     * @param string $start_date Date in Y-m-d format
     * @param string $end_date Date in Y-m-d format
     * @return array Array of date => holiday_name
     */
    public static function getHolidaysInRange($start_date, $end_date) {
        $range_holidays = [];
        foreach (self::$holidays as $date => $name) {
            if ($date >= $start_date && $date <= $end_date) {
                $range_holidays[$date] = $name;
            }
        }
        return $range_holidays;
    }
}